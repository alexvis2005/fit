<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
<link rel="icon" type="image/svg+xml" href="iconco.svg">
<link rel="alternate icon" href="iconco.png">
    <title>–î–ù–ï–í–ù–ò–ö –ù–ê–ë–õ–Æ–î–ï–ù–ò–ô: –û–¢–ñ–ò–ú–ê–ù–ò–Ø</title>
    <style>
        :root {
            --bg: #f3f0ed;
            --text: #3a3633;
            --border: #c9c3bd;
            --card-bg: #fdfcfb;
            --primary: #5e5046;
            --success: #4a6e58;
            --rest: #7a7269;
            --incomplete: #b5a99e;
            --line: #e8e3de;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'IBM Plex Mono', 'Courier New', monospace;
            background-color: var(--bg);
            color: var(--text);
            line-height: 1.5;
            padding: 16px;
        }

        .container {
            max-width: 840px;
            margin: 0 auto;
        }

        header {
            padding: 24px 0 16px;
            border-bottom: 1px solid var(--line);
        }

        .title {
            font-size: 1.4rem;
            font-weight: 600;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }

        .subtitle {
            font-size: 0.9rem;
            color: var(--primary);
            opacity: 0.8;
        }

        /* –ù–û–í–´–ô –ë–õ–û–ö: –ü–ï–†–ï–•–û–î –ö –ü–ò–¢–ê–ù–ò–Æ */
        .navigation-link {
            margin: 16px 0;
            text-align: center;
        }

        .nav-btn {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background-color: var(--card-bg);
            color: var(--text);
            border: 1px solid var(--border);
            font-family: inherit;
            font-size: 0.95rem;
            font-weight: 600;
            text-decoration: none;
            /* –ü–†–Ø–ú–´–ï –£–ì–õ–´ */
            border-radius: 0;
            transition: background-color 0.2s;
        }

        .nav-btn:hover {
            background-color: #f0eee9;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1px;
            background-color: var(--border);
            margin: 16px 0;
        }

        .stat-item {
            background-color: var(--card-bg);
            padding: 16px 12px;
            text-align: center;
            font-size: 1.1rem;
        }

        .stat-value {
            font-weight: 700;
            font-size: 1.4rem;
            margin: 4px 0;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: var(--primary);
            opacity: 0.7;
        }

        .controls {
            display: flex;
            gap: 8px;
            margin: 16px 0;
            flex-wrap: wrap;
        }

        .btn {
            padding: 10px 16px;
            background-color: var(--card-bg);
            color: var(--text);
            border: 1px solid var(--border);
            font-family: inherit;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 0;
        }

        .btn:hover {
            background-color: #f9f7f5;
        }

        .btn--primary {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .filters {
            display: flex;
            gap: 1px;
            margin: 16px 0;
            background-color: var(--border);
            height: 36px;
        }

        .filter {
            flex: 1;
            background-color: var(--card-bg);
            border: none;
            font-family: inherit;
            font-size: 0.85rem;
            color: var(--text);
            cursor: pointer;
            padding: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .filter.active {
            background-color: var(--primary);
            color: white;
        }

        .day-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            padding: 16px;
            margin-bottom: 12px;
            font-size: 0.95rem;
            border-radius: 0;
        }

        .day-card.completed {
            border-color: var(--success);
        }

        .day-card.rest {
            background-color: #faf8f6;
            border-color: var(--rest);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--line);
        }

        .date {
            font-weight: 600;
            font-size: 1.1rem;
        }

        .status {
            font-size: 0.8rem;
            padding: 2px 8px;
            background-color: var(--incomplete);
            color: white;
        }

        .day-card.completed .status {
            background-color: var(--success);
        }

        .day-card.rest .status {
            background-color: var(--rest);
        }

        .exercise-list {
            list-style-type: none;
        }

        .exercise-item {
            padding: 4px 0;
            display: flex;
        }

        .exercise-icon {
            width: 20px;
            text-align: center;
            font-weight: bold;
            margin-right: 8px;
            color: var(--primary);
        }

        .mark-btn {
            width: 28px;
            height: 28px;
            background-color: var(--card-bg);
            border: 1px solid var(--border);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            float: right;
            margin-top: -8px;
            border-radius: 0;
        }

        .mark-btn:hover:not(.disabled) {
            background-color: #f0eee9;
        }

        .mark-btn.checked {
            background-color: var(--success);
            color: white;
            border-color: var(--success);
        }

        .mark-btn.rest {
            background-color: var(--rest);
            color: white;
            cursor: default;
        }

        .motivation {
            font-style: normal;
            margin: 12px 0;
            padding: 12px;
            background-color: var(--card-bg);
            border-left: 2px solid var(--primary);
            font-size: 1rem;
        }

        footer {
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--line);
            font-size: 0.85rem;
            color: var(--primary);
            opacity: 0.7;
        }

        @media (max-width: 600px) {
            .stats { grid-template-columns: 1fr; }
            .controls { flex-direction: column; }
            .btn { width: 100%; }
            .filters { flex-wrap: wrap; height: auto; }
            .filter { height: 36px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="title">–î–ù–ï–í–ù–ò–ö –ù–ê–ë–õ–Æ–î–ï–ù–ò–ô: –û–¢–ñ–ò–ú–ê–ù–ò–Ø</div>
            <div class="subtitle">01.12.2025 ‚Äî 01.01.2026 | –ü–Ω‚Äì–°–±: —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞, –í—Å: –æ—Ç–¥—ã—Ö</div>
        </header>

        <!-- üîó –ù–û–í–ê–Ø –ö–ù–û–ü–ö–ê -->
        <div class="navigation-link">
            <a href="food.html" class="nav-btn">üçΩÔ∏è –ü–ª–∞–Ω –ø–∏—Ç–∞–Ω–∏—è (2000 –∫–∫–∞–ª)</a>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-value" id="completedDays">0</div>
                <div class="stat-label">–¥–Ω–µ–π</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="totalPushups">0</div>
                <div class="stat-label">–æ—Ç–∂–∏–º–∞–Ω–∏–π</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="progress">0%</div>
                <div class="stat-label">–ø—Ä–æ–≥—Ä–µ—Å—Å</div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn--primary" id="markToday">–û—Ç–º–µ—Ç–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è</button>
            <button class="btn" id="resetAll">–°–±—Ä–æ—Å–∏—Ç—å –≤—Å—ë</button>
            <button class="btn btn--success" id="export">–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
        </div>

        <div class="filters">
            <button class="filter active" data-filter="all">–í—Å–µ</button>
            <button class="filter" data-filter="workout">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏</button>
            <button class="filter" data-filter="rest">–û—Ç–¥—ã—Ö</button>
            <button class="filter" data-filter="incomplete">–ù–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ</button>
        </div>

        <div id="calendar">
            <!-- –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è JS -->
        </div>

        <div class="motivation" id="motivation">
            –§–∏–∫—Å–∏—Ä—É–π. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π. –£–ª—É—á—à–∞–π.
        </div>

        <footer>
            <div>–ê–ª–µ–∫—Å–µ–π –í–∏—Å–ª—è–µ–≤ | –ú–æ—Å–∫–≤–∞ | –î–µ–∫–∞–±—Ä—å 2025</div>
            <div>–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è ‚Äî –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ.</div>
        </footer>
    </div>

    <div class="notification" id="notification" style="
        position: fixed; top: 16px; right: 16px;
        background-color: var(--card-bg); border: 1px solid var(--border);
        padding: 12px 16px; font-size: 0.9rem;
        opacity: 0; transform: translateX(120%);
        transition: all 0.3s; z-index: 100;
    "></div>

    <script>
        const plan = [
            { d: "01.12 (–ø–Ω)", t: "w", e: ["30 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö"] },
            { d: "02.12 (–≤—Ç)", t: "w", e: ["30 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö"] },
            { d: "03.12 (—Å—Ä)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "30 —à–∏—Ä–æ–∫–∏—Ö", "–¢—è–≥–∞ 3√ó10", "–ü–ª–∞–Ω–∫–∞ 2√ó30—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "04.12 (—á—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "34 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö", "–¢—è–≥–∞ 3√ó12", "–ü–ª–∞–Ω–∫–∞ 45—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "05.12 (–ø—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "32 —É–∑–∫–∏—Ö", "–¢—è–≥–∞ 2√ó15", "–ü–ª–∞–Ω–∫–∞ 2√ó35—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "06.12 (—Å–±)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "35+ –ø–∏—Ä–∞–º–∏–¥–∞", "–¢—è–≥–∞ 3√ó10", "–ü–ª–∞–Ω–∫–∞ 60—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "07.12 (–≤—Å)", t: "r", e: ["–ü–æ–ª–Ω—ã–π –æ—Ç–¥—ã—Ö"] },
            { d: "08.12 (–ø–Ω)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "36 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö", "–¢—è–≥–∞ 4√ó10", "–ü–ª–∞–Ω–∫–∞ 80—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "09.12 (–≤—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "35 —à–∏—Ä–æ–∫–∏—Ö", "–¢—è–≥–∞ 3√ó12", "–ü–ª–∞–Ω–∫–∞ 70—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "10.12 (—Å—Ä)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "38 —É–∑–∫–∏—Ö", "–¢—è–≥–∞ 5√ó8", "–ü–ª–∞–Ω–∫–∞ 90—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "11.12 (—á—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "–°—É–ø–µ—Ä—Å–µ—Ç 30+24", "–ü–ª–∞–Ω–∫–∞ 3√ó30—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "12.12 (–ø—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "38 —Å–º–µ—à–∞–Ω–Ω—ã—Ö", "–¢—è–≥–∞ 3√ó15", "–ü–ª–∞–Ω–∫–∞ 80—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "13.12 (—Å–±)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "–¢–µ—Å—Ç +10", "–¢—è–≥–∞ 2√ó20", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "14.12 (–≤—Å)", t: "r", e: ["–ü–æ–ª–Ω—ã–π –æ—Ç–¥—ã—Ö"] },
            { d: "15.12 (–ø–Ω)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "40 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö", "–¢—è–≥–∞ 4√ó12", "–ü–ª–∞–Ω–∫–∞ 100—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "16.12 (–≤—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "33 –Ω–æ–≥–∏ –≤–≤–µ—Ä—Ö", "–¢—è–≥–∞ –¥–æ –æ—Ç–∫–∞–∑–∞", "–ü–ª–∞–Ω–∫–∞ 90—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "17.12 (—Å—Ä)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "40 —É–∑–∫–∏—Ö (–ø–∞—É–∑–∞)", "–¢—è–≥–∞ 5√ó10", "–ü–ª–∞–Ω–∫–∞ 120—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "18.12 (—á—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "45 –ª–µ—Å–µ–Ω–∫–∞", "–¢—è–≥–∞ 12‚Üí10‚Üí8‚Üí6", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "19.12 (–ø—Ç)", t: "w", e: ["–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π –¥–µ–Ω—å: 90 –æ—Ç–∂–∏–º–∞–Ω–∏–π", "–†–∞—Å—Ç—è–∂–∫–∞ 10 –º–∏–Ω"] },
            { d: "20.12 (—Å–±)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "50 —Å–≤–æ–±–æ–¥–Ω—ã—Ö", "–¢—è–≥–∞ 4√ó15", "–ü–ª–∞–Ω–∫–∞ 120—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "21.12 (–≤—Å)", t: "r", e: ["–ü–æ–ª–Ω—ã–π –æ—Ç–¥—ã—Ö"] },
            { d: "22.12 (–ø–Ω)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "45 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö", "–¢—è–≥–∞ 3√ó12", "–ü–ª–∞–Ω–∫–∞ 120—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "23.12 (–≤—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "80 —ë–ª–∫–∞", "–°–∫—Ä—É—á–∏–≤–∞–Ω–∏—è 3√ó20", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "24.12 (—Å—Ä)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "32 —Å—Ç—É–ø–µ–Ω—å–∫–∏", "–¢—è–≥–∞ 3√ó12", "–ü–ª–∞–Ω–∫–∞ 150—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "25.12 (—á—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "45 (—à–∏—Ä.+–Ω–æ–≥–∏)", "–¢—è–≥–∞ 5√ó8", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "26.12 (–ø—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "30 —É–∑–∫–∏—Ö", "–¢—è–≥–∞ 2√ó15", "–†–∞—Å—Ç—è–∂–∫–∞"] },
            { d: "27.12 (—Å–±)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "–¢–µ—Å—Ç –≤ 3 —Å—Ç–∏–ª—è—Ö", "–¢—è–≥–∞ 2√ó20", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "28.12 (–≤—Å)", t: "r", e: ["–ü–æ–ª–Ω—ã–π –æ—Ç–¥—ã—Ö"] },
            { d: "29.12 (–ø–Ω)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "45 –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö", "–¢—è–≥–∞ 3√ó12", "–ü–ª–∞–Ω–∫–∞ 120—Å", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "30.12 (–≤—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "40 —à–∏—Ä–æ–∫–∏—Ö", "–¢—è–≥–∞ 2√ó15", "–ó–∞–º–∏–Ω–∫–∞"] },
            { d: "31.12 (—Å—Ä)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "31 –æ—Ç–∂–∏–º–∞–Ω–∏–µ", "–†–∞—Å—Ç—è–∂–∫–∞", "–ê–Ω–∞–ª–∏–∑ –º–µ—Å—è—Ü–∞"] },
            { d: "01.01 (—á—Ç)", t: "w", e: ["–†–∞–∑–º–∏–Ω–∫–∞", "–§–∏–Ω–∞–ª—å–Ω—ã–π —Ç–µ—Å—Ç", "–ó–∞–º–∏–Ω–∫–∞", "–ü–æ–¥–≤–µ–¥–µ–Ω–∏–µ –∏—Ç–æ–≥–æ–≤"] }
        ];

        const motivations = [
            "–§–∏–∫—Å–∏—Ä—É–π. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π. –£–ª—É—á—à–∞–π.",
            "–î–∞–Ω–Ω—ã–µ –Ω–µ –ª–≥—É—Ç. –î–∏—Å—Ü–∏–ø–ª–∏–Ω–∞ ‚Äî –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏.",
            "–ö–∞–∂–¥–æ–µ –æ—Ç–∂–∏–º–∞–Ω–∏–µ ‚Äî —Ç–æ—á–∫–∞ –≤ –ª–æ–≥–µ. –ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî –Ω–æ–≤–∞—è —Å—Ç—Ä–æ–∫–∞.",
            "–†–µ–∑—É–ª—å—Ç–∞—Ç ‚Äî —Å–ª–µ–¥—Å—Ç–≤–∏–µ. –ê —Å–ª–µ–¥—Å—Ç–≤–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏—á–∏–Ω.",
            "–¢—ã –Ω–µ —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å –º—ã—à—Ü—ã. –¢—ã —Ç—Ä–µ–Ω–∏—Ä—É–µ—à—å —Ö–∞—Ä–∞–∫—Ç–µ—Ä."
        ];

        const STORAGE_KEY = 'pushup_log_strict';
        let state = {
            completed: new Set(),
            details: {}
        };

        const cal = document.getElementById('calendar');
        const cdEl = document.getElementById('completedDays');
        const tpEl = document.getElementById('totalPushups');
        const prEl = document.getElementById('progress');
        const motEl = document.getElementById('motivation');
        const notif = document.getElementById('notification');

        function init() {
            load(); render(); updateStats(); bind();
        }

        function load() {
            try {
                const d = localStorage.getItem(STORAGE_KEY);
                if (d) {
                    const s = JSON.parse(d);
                    state.completed = new Set(s.c || []);
                    state.details = s.d || {};
                }
            } catch (e) { console.warn('Reset'); }
        }

        function save() {
            localStorage.setItem(STORAGE_KEY, JSON.stringify({
                c: Array.from(state.completed),
                d: state.details
            }));
        }

        function getStats() {
            let c = 0, p = 0;
            for (let i = 0; i < plan.length; i++) {
                if (state.completed.has(i)) {
                    c++;
                    const d = state.details[i];
                    p += d?.p || 30;
                }
            }
            return { c, p, total: plan.length };
        }

        function updateStats() {
            const s = getStats();
            cdEl.textContent = s.c;
            tpEl.textContent = s.p;
            prEl.textContent = `${Math.round((s.c / s.total) * 100)}%`;
            motEl.textContent = motivations[Math.min(4, Math.floor(s.c / 7))];
        }

        function render(filter = 'all') {
            cal.innerHTML = '';
            plan.forEach((day, i) => {
                const done = state.completed.has(i);
                const d = state.details[i] || {};

                if (filter === 'workout' && day.t !== 'w') return;
                if (filter === 'rest' && day.t !== 'r') return;
                if (filter === 'incomplete' && done) return;

                const card = document.createElement('div');
                card.className = `day-card${done ? ' completed' : ''}${day.t === 'r' ? ' rest' : ''}`;
                card.dataset.i = i;

                const status = done ? '‚úì' : (day.t === 'r' ? '–æ—Ç–¥—ã—Ö' : '–æ–∂–∏–¥–∞–µ—Ç');
                const statusCls = done ? 'success' : (day.t === 'r' ? 'rest' : 'incomplete');

                card.innerHTML = `
                    <div class="day-header">
                        <div class="date">${day.d}</div>
                        <div class="status ${statusCls}">${status}</div>
                    </div>
                    <ul class="exercise-list">
                        ${day.e.map(ex => {
                            let icon = '‚Ä¢';
                            if (ex.includes('–æ—Ç–∂–∏–º–∞–Ω')) icon = 'üí™';
                            else if (ex.includes('–†–∞–∑–º–∏–Ω–∫–∞')) icon = '‚Üí';
                            else if (ex.includes('–¢—è–≥–∞')) icon = '‚Äì';
                            else if (ex.includes('–ü–ª–∞–Ω–∫–∞')) icon = '‚ñÆ';
                            else if (ex.includes('–ó–∞–º–∏–Ω–∫–∞')) icon = '‚Üê';
                            else if (ex.includes('–¢–µ—Å—Ç')) icon = '=';
                            return `<li class="exercise-item"><span class="exercise-icon">${icon}</span>${ex}</li>`;
                        }).join('')}
                    </ul>
                    ${done && d.p ? `<div style="margin-top:6px;font-size:0.8rem;opacity:0.7;">${d.p} –æ—Ç–∂.</div>` : ''}
                    <button class="mark-btn${done ? ' checked' : ''}${day.t === 'r' ? ' rest disabled' : ''}" data-i="${i}">
                        ${done ? '‚úì' : (day.t === 'r' ? '‚Äî' : '+')}
                    </button>
                `;
                cal.appendChild(card);
            });

            cal.querySelectorAll('.mark-btn:not(.disabled)').forEach(btn => {
                btn.onclick = () => toggleDay(+btn.dataset.i);
            });
        }

        function toggleDay(i) {
            const day = plan[i];
            if (state.completed.has(i)) {
                state.completed.delete(i);
                delete state.details[i];
            } else {
                const def = day.e.find(e => e.includes('–æ—Ç–∂–∏–º–∞–Ω')) || day.e.find(e => /\d+/.test(e)) || '';
                const match = def.match(/\d+/);
                const defP = match ? parseInt(match[0]) : 30;
                const p = prompt(`–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—Ç–∂–∏–º–∞–Ω–∏–π (${defP} –ø–æ –ø–ª–∞–Ω—É):`, defP);
                if (p === null) return;
                const num = parseInt(p);
                if (isNaN(num) || num < 0) return alert('–ß–∏—Å–ª–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å ‚â• 0');
                state.completed.add(i);
                state.details[i] = { p: num };
            }
            save(); updateStats(); render();
        }

        function markToday() {
            for (let i = 0; i < plan.length; i++) {
                if (!state.completed.has(i) && plan[i].t === 'w') {
                    toggleDay(i);
                    return;
                }
            }
            notify('–í—Å–µ –¥–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã.');
        }

        function resetAll() {
            if (confirm('–°–±—Ä–æ—Å–∏—Ç—å –≤–µ—Å—å –ª–æ–≥?')) {
                state = { completed: new Set(), details: {} };
                localStorage.removeItem(STORAGE_KEY);
                render(); updateStats();
                notify('–õ–æ–≥ —Å–±—Ä–æ—à–µ–Ω.');
            }
        }

        function exportData() {
            const s = getStats();
            let csv = '–î–∞—Ç–∞;–¢–∏–ø;–û—Ç–∂–∏–º–∞–Ω–∏–π;–í—ã–ø–æ–ª–Ω–µ–Ω–æ\n';
            plan.forEach((d, i) => {
                const det = state.details[i] || {};
                csv += `${d.d};${d.t === 'w' ? '—Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞' : '–æ—Ç–¥—ã—Ö'};${det.p || 0};${state.completed.has(i) ? '–¥–∞' : '–Ω–µ—Ç'}\n`;
            });
            csv += `\n–ò—Ç–æ–≥–æ:;${s.total} –¥–Ω–µ–π;${s.p} –æ—Ç–∂–∏–º–∞–Ω–∏–π;${s.c} –≤—ã–ø–æ–ª–Ω–µ–Ω–æ`;
            const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `log_aleksey_${new Date().toISOString().slice(0,10)}.csv`;
            a.click();
            URL.revokeObjectURL(url);
            notify('–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω.');
        }

        function notify(msg) {
            notif.textContent = msg;
            notif.style.opacity = '1';
            notif.style.transform = 'translateX(0)';
            setTimeout(() => {
                notif.style.opacity = '0';
                notif.style.transform = 'translateX(120%)';
            }, 2500);
        }

        function bind() {
            document.getElementById('markToday').onclick = markToday;
            document.getElementById('resetAll').onclick = resetAll;
            document.getElementById('export').onclick = exportData;

            document.querySelectorAll('.filter').forEach(btn => {
                btn.onclick = () => {
                    document.querySelectorAll('.filter').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    render(btn.dataset.filter);
                };
            });
        }

        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>